<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Допустим у нас в таске не просто возврат числа, а некоторая ооочень длительная операция. Если мы выполним все синхронно, то наш UI поток будет занят этими расчетами и не будет обрабатывать очередь сообщений. Т.е. наша программа повиснет на время выполнения нашей задачи.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image15984125136fiob7rkye.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Но есть ведь асинхронное программирование - давайте воспользуемся await. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Выполняем данный кусок кода, как будто это обычный метод</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2. Тут (где стрелка) мы завершаем наш метод до получения результата - UI поток освободился и может спокойно обрабатывать очередь сообщений, ничего не виснет ведь метод Button_Click завершен</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3. Но тут у нас появился результат и что же делать ? Нам надо опять отработать оставшийся код, но где ? Очевидно что опять в UI потоке, но не в другом, иначе наше приложение вылетит с исключением.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">И тут на сцену выходит контекст синхронизации, используя который, наш асинхронный метод знает где ему продолжить выполнение. Поэтому текст нашей метки изменяется без ошибок.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При выполнении асинхронного метода контекст сохраняется (иначе определить где продолжить выполнение невозможно)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если контекст синхронизации не задан (null)  - это значит что нам все равно где будет продолжение (обычно это тредпул). По поводу null все итак ясно, но как указать что нам все равно - явным образом ? И тут разгадка на сегодняшний вопрос.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>