<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">using</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> System;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">using</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> System.IO;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">using</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> System.Text.RegularExpressions;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:small; color:#666666;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#808080;">///</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;summary&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#808080;">///</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;"> Замена текста в файле</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#808080;">///</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;/summary&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#808080;">///</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;param name=&quot;filePath&quot;&gt;</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;">Path of the text file.</span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;/param&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#808080;">///</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;param name=&quot;searchText&quot;&gt;</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;">Text to search for.</span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;/param&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#808080;">///</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;param name=&quot;replaceText&quot;&gt;</span><span style=" font-family:'Courier New'; font-size:small; color:#008000;">Text to replace the search text.</span><span style=" font-family:'Courier New'; font-size:small; color:#808080;">&lt;/param&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">static</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">public</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">void</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> ReplaceInFile( </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">string</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> filePath, </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">string</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> searchText, </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">string</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> replaceText )</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    </span><span style=" font-family:'Courier New'; font-size:small; color:#2b91af;">StreamReader</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> reader = </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">new</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#2b91af;">StreamReader</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;">( filePath );</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">string</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> content = reader.ReadToEnd();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    reader.Close();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:small; color:#666666;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    content = </span><span style=" font-family:'Courier New'; font-size:small; color:#2b91af;">Regex</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;">.Replace( content, searchText, replaceText );</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:small; color:#666666;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    </span><span style=" font-family:'Courier New'; font-size:small; color:#2b91af;">StreamWriter</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> writer = </span><span style=" font-family:'Courier New'; font-size:small; color:#0000ff;">new</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;"> </span><span style=" font-family:'Courier New'; font-size:small; color:#2b91af;">StreamWriter</span><span style=" font-family:'Courier New'; font-size:small; color:#666666;">( filePath );</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    writer.Write( content );</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">    writer.Close();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:small; color:#666666;">}</span></p></body></html>