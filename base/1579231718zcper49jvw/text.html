<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:18px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:15px; color:#242729;">A possible reason is because the row id is not zero based or there are jumps due to deleted rows and similar things, hence it can't be used as array row index. Replacing foreach with a for could be an idea to fix it.</span></p>
<p style=" margin-top:0px; margin-bottom:18px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:15px; color:#242729;">Furthermore you're dimensioning the matrix with the id of the last row, that is not guaranteed to be the max id.</span></p>
<p style=" margin-top:0px; margin-bottom:18px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:15px; color:#242729;">And even if it is and it is zero based, you need to add one to get the correct row dimension.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'inherit'; font-size:13px; color:#101094; background-color:#eff0f1;">string</span><span style=" font-family:'inherit'; font-size:13px; color:#303336; background-color:#eff0f1;">[,] data = </span><span style=" font-family:'inherit'; font-size:13px; color:#101094; background-color:#eff0f1;">new</span><span style=" font-family:'inherit'; font-size:13px; color:#303336; background-color:#eff0f1;"> </span><span style=" font-family:'inherit'; font-size:13px; color:#101094; background-color:#eff0f1;">string</span><span style=" font-family:'inherit'; font-size:13px; color:#303336; background-color:#eff0f1;">[d1+</span><span style=" font-family:'inherit'; font-size:13px; color:#7d2727; background-color:#eff0f1;">1</span><span style=" font-family:'inherit'; font-size:13px; color:#303336; background-color:#eff0f1;">, d2]; </span></p>
<p style=" margin-top:0px; margin-bottom:18px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:15px; color:#242729;">But a Count instead of Last would be more reasonable in the first place.</span></p>
<p style=" margin-top:4px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/39179710"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#848d95;">share</span></a><a href="https://stackoverflow.com/posts/39179710/edit"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#848d95;">improve this answer</span></a></p>
<p style=" margin-top:4px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/39179710/revisions"><span style=" font-family:'inherit'; font-size:12px; text-decoration: underline; color:#0077cc;">edited Aug 27 '16 at 11:30</span></a></p>
<p style=" margin-top:4px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; color:#6a737c;">answered Aug 27 '16 at 9:48</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:8px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:17px;"><span style=" font-family:'inherit'; font-size:13px; color:#6a737c;">user6996876</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comments-39179710"></a><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">w</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">hen rows got deleted, doesnt the next rows fill up the blank and get shifted up automatically? and isn't the first row always start on an index of 0?</span><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> – </span><a href="https://stackoverflow.com/users/4696558/infinity-loop-of-probs"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#0077cc; background-color:#e1ecf4;">Infinity loop of probs</span></a><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> </span><a href="https://stackoverflow.com/questions/39179376/index-was-outside-the-bounds-of-the-array-using-sqlite-and-c-sharp#comment65701022_39179710"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;">Aug 27 '16 at 9:55</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-65701080"></a><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">W</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">hen a row is deleted the id of the following one does not change</span><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> – user6996876 </span><a href="https://stackoverflow.com/questions/39179376/index-was-outside-the-bounds-of-the-array-using-sqlite-and-c-sharp#comment65701080_39179710"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;">Aug 27 '16 at 9:59</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-65701460"></a><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">s</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">o how do you move it to fill the blank?</span><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> – </span><a href="https://stackoverflow.com/users/4696558/infinity-loop-of-probs"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#0077cc; background-color:#e1ecf4;">Infinity loop of probs</span></a><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> </span><a href="https://stackoverflow.com/questions/39179376/index-was-outside-the-bounds-of-the-array-using-sqlite-and-c-sharp#comment65701460_39179710"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;">Aug 27 '16 at 10:19</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-65702447"></a><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">B</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">ack to the exception. You're dimensioning the matrix with the I'd of the last row and also this is not guaranteed to be the max id.</span><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> – user6996876 </span><a href="https://stackoverflow.com/questions/39179376/index-was-outside-the-bounds-of-the-array-using-sqlite-and-c-sharp#comment65702447_39179710"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;">Aug 27 '16 at 11:18</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-65702755"></a><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">F</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:13px; color:#242729;">inally, if you have N rows the last one will likely have id N-1 and that is not the correct dimension (N) to instanciate the matrix</span><span style=" font-family:'inherit'; font-size:13px; color:#242729;"> – user6996876 </span><a href="https://stackoverflow.com/questions/39179376/index-was-outside-the-bounds-of-the-array-using-sqlite-and-c-sharp#comment65702755_39179710"><span style=" font-family:'inherit'; font-size:13px; text-decoration: underline; color:#9199a1;">Aug 27 '16 at 11:36</span></a><span style=" font-family:'inherit'; font-size:13px; color:#000000;"> </span></p></body></html>