<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">BackgroundWoker предоставляет следующие основные методы:<br /><br /></span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; color:#000000;">RunWorkerAsync</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;"> - служит для запуска потока.<br /></span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; color:#000000;">DoWork</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;"> - вызывается при старте потока. В этом методе обычно выполняется длительное вычисление, которое будет выполняться в отдельном потоке.<br /></span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; color:#000000;">RunWorkerCompleted</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;"> - вызывается по завершении выполнения потока и если поддерживается досрочное завершение при досрочном завершении.<br /></span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; color:#000000;">ProgressChanged</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;"> - может быть использован для отслеживания прогресса выполнения фонового потока.<br /></span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; color:#000000;">CancelAsync</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;"> - можно использовать для досрочного завершения фоновой операции. CancelAsync устанавливает соответствующее значение свойства CancellationPending. Фоновый код, поддерживающий досрочное завершение, проверяет значение этого свойства и, как только оно становится равным True, завершает свое выполнение.<br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">Объявление BackgroundWorker в XAML коде.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">Сначала нужно указать пространство имен System.ComponentModel, а дальше создать экземпляр BackgroundWorker в разделе ресурсов окна.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000; background-color:#f7f7f7;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Window.Resources</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">my:BackgroundWorker</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">x:Key</span><span style=" font-size:small; color:#0000ff;">=&quot;backgroundWoker&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">WorkerReportsProgress</span><span style=" font-size:small; color:#0000ff;">=&quot;True&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">WorkerSupportsCancellation</span><span style=" font-size:small; color:#0000ff;">=&quot;True&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">DoWork</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker_DoWork&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">ProgressChanged</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker_ProgressChanged&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">RunWorkerCompleted</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker_RunWorkerCompleted&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">my:BackgroundWorker</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">Window.Resources</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">* This source code was highlighted with </span><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#808080;">Source Code Highlighter</span></a><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">Теперь для получения доступа к ресурсу в коде прописываем в кострукторе окна и не забываем про uses System.ComponentModel:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000; background-color:#f7f7f7;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">public</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">partial</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">class</span><span style=" font-size:small;"> MainWindow : Window</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> BackgroundWorker backgroundWorker;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">public</span><span style=" font-size:small;"> MainWindow()</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      InitializeComponent();</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      backgroundWorker = (BackgroundWorker)</span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.FindResource(</span><span style=" font-size:small; color:#a31515;">&quot;backgroundWoker&quot;</span><span style=" font-size:small;">);</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  ...</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">* This source code was highlighted with </span><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#808080;">Source Code Highlighter</span></a><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-weight:600; color:#004080;">Отслеживание прогресса</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">Мы установили BackgroundWoker.WokerReportsProgress в True для возможности отслеживания прогресса в выполнении. В коде события DoWork мы должны вызвать метод ReportProgress() и указать процент готовности. При каждом вызове ReportProgress() объект BackgroundWoker инициирует событие ProgressChanged. Это событие считывает процент готовности и обновляет интерфейс. Важно, что событие ProgressChanged инициировано в потоке пользовательского интерфейса, поэтому никаких дополнительных действий предпринимать не надо.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-weight:600; color:#004080;">Поддержка отмены</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">Для поддержки отмены добавим кнопку &quot;Отмена&quot; и также мы уже указали явно в XAML коде </span><span style=" font-family:'Courier New'; font-size:8.25pt; color:#ff0000;">WorkerSupportsCancellation</span><span style=" font-family:'Courier New'; font-size:8.25pt; color:#0000ff;">=&quot;True&quot;</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;"> . При нажатии на кнопку в событии Click вызываем метод BackgroundWorker.CancelAsync(), теперь в коде DoWork при проверке if (worker.CancellationPending == </span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#0000ff;">true</span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">) мы просто возвращаем управление ничего не делая. Важно, что даже при отмене генерируется событие RunWokerCompleted, поэтому это нужно предусмотреть и обработать соотвественно.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-weight:600; color:#004080;">Дополнения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">В код, полный текст которого приведен ниже, добавлено изменение видимости </span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#800000;">ProgressBar </span><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">в зависимости от логики и доступность кнопок &quot;Старт&quot; и &quot;Отмена&quot;. Т.е. пока процесс не запушен кнопка &quot;Отмена&quot; не доступна, когда процесс запущен, то доступна кнопка &quot;Отмена&quot;, а кнопка &quot;Старт&quot; становиться не доступна.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1577417009y80cbezfqv.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">Вот, полный текст XAML файла</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000; background-color:#f7f7f7;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Window</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">x:Class</span><span style=" font-size:small; color:#0000ff;">=&quot;BWTest.MainWindow&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#ff0000;">xmlns</span><span style=" font-size:small; color:#0000ff;">=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#ff0000;">xmlns:x</span><span style=" font-size:small; color:#0000ff;">=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#ff0000;">xmlns:my</span><span style=" font-size:small; color:#0000ff;">=&quot;clr-namespace:System.ComponentModel;assembly=System&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#ff0000;">Title</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker тест&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;150&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Width</span><span style=" font-size:small; color:#0000ff;">=&quot;250&quot;&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Window.Resources</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">my:BackgroundWorker</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">x:Key</span><span style=" font-size:small; color:#0000ff;">=&quot;backgroundWoker&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">WorkerReportsProgress</span><span style=" font-size:small; color:#0000ff;">=&quot;True&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">WorkerSupportsCancellation</span><span style=" font-size:small; color:#0000ff;">=&quot;True&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">DoWork</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker_DoWork&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">ProgressChanged</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker_ProgressChanged&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#ff0000;">RunWorkerCompleted</span><span style=" font-size:small; color:#0000ff;">=&quot;BackgroundWorker_RunWorkerCompleted&quot;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">my:BackgroundWorker</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">Window.Resources</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Grid</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Grid.RowDefinitions</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">RowDefinition</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;100*&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">MinHeight</span><span style=" font-size:small; color:#0000ff;">=&quot;70&quot;&gt;&lt;/</span><span style=" font-size:small; color:#800000;">RowDefinition</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">RowDefinition</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;40*&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">MinHeight</span><span style=" font-size:small; color:#0000ff;">=&quot;40&quot;&gt;&lt;/</span><span style=" font-size:small; color:#800000;">RowDefinition</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">Grid.RowDefinitions</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Button</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Content</span><span style=" font-size:small; color:#0000ff;">=&quot;Старт&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;23&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">HorizontalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Left&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Name</span><span style=" font-size:small; color:#0000ff;">=&quot;btnStart&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">VerticalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Top&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Width</span><span style=" font-size:small; color:#0000ff;">=&quot;75&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Click</span><span style=" font-size:small; color:#0000ff;">=&quot;btnStart_Click&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">/&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Button</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Content</span><span style=" font-size:small; color:#0000ff;">=&quot;Отмена&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;23&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">HorizontalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Left&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Margin</span><span style=" font-size:small; color:#0000ff;">=&quot;81,0,0,0&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Name</span><span style=" font-size:small; color:#0000ff;">=&quot;btnCancel&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">VerticalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Top&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Width</span><span style=" font-size:small; color:#0000ff;">=&quot;75&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Click</span><span style=" font-size:small; color:#0000ff;">=&quot;btnCancel_Click&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">IsEnabled</span><span style=" font-size:small; color:#0000ff;">=&quot;False&quot;/&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">DockPanel</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Grid</span><span style=" font-size:small;">.</span><span style=" font-size:small; color:#ff0000;">Row</span><span style=" font-size:small; color:#0000ff;">=&quot;1&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Background</span><span style=" font-size:small; color:#0000ff;">=&quot;Beige&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">VerticalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Bottom&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">HorizontalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Stretch&quot;&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">StatusBar</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">DockPanel</span><span style=" font-size:small;">.</span><span style=" font-size:small; color:#ff0000;">Dock</span><span style=" font-size:small; color:#0000ff;">=&quot;Left&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;40&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">MinHeight</span><span style=" font-size:small; color:#0000ff;">=&quot;30&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">HorizontalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Left&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">VerticalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Center&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Name</span><span style=" font-size:small; color:#0000ff;">=&quot;statusBar&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Background</span><span style=" font-size:small; color:#0000ff;">=&quot;Beige&quot;&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">StatusBarItem</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">          </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">ProgressBar</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;10&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">MinHeight</span><span style=" font-size:small; color:#0000ff;">=&quot;10&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Name</span><span style=" font-size:small; color:#0000ff;">=&quot;progressBar&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Width</span><span style=" font-size:small; color:#0000ff;">=&quot;100&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Visibility</span><span style=" font-size:small; color:#0000ff;">=&quot;Hidden&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">/&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">StatusBarItem</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">StatusBarItem</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">MinHeight</span><span style=" font-size:small; color:#0000ff;">=&quot;30&quot;&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">          </span><span style=" font-size:small; color:#0000ff;">&lt;</span><span style=" font-size:small; color:#800000;">Label</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Height</span><span style=" font-size:small; color:#0000ff;">=&quot;30&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Name</span><span style=" font-size:small; color:#0000ff;">=&quot;txtProgress&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">HorizontalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Left&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">VerticalAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Center&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">VerticalContentAlignment</span><span style=" font-size:small; color:#0000ff;">=&quot;Center&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#ff0000;">Width</span><span style=" font-size:small; color:#0000ff;">=&quot;100&quot;</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">/&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">StatusBarItem</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">StatusBar</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">DockPanel</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">Grid</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small; color:#0000ff;">&lt;/</span><span style=" font-size:small; color:#800000;">Window</span><span style=" font-size:small; color:#0000ff;">&gt;</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">* This source code was highlighted with </span><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#808080;">Source Code Highlighter</span></a><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; color:#000000;">И полный текст кода  на C#</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000; background-color:#f7f7f7;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small; color:#0000ff;">using</span><span style=" font-size:small;"> System.Windows;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small; color:#0000ff;">using</span><span style=" font-size:small;"> System.ComponentModel;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small; color:#0000ff;">namespace</span><span style=" font-size:small;"> BWTest</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">{</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  </span><span style=" font-size:small; color:#0000ff;">public</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">partial</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">class</span><span style=" font-size:small;"> MainWindow : Window</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> BackgroundWorker backgroundWorker;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">public</span><span style=" font-size:small;"> MainWindow()</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      InitializeComponent();</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      backgroundWorker = (BackgroundWorker)</span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.FindResource(</span><span style=" font-size:small; color:#a31515;">&quot;backgroundWoker&quot;</span><span style=" font-size:small;">);</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">void</span><span style=" font-size:small;"> BackgroundWorker_ProgressChanged(</span><span style=" font-size:small; color:#0000ff;">object</span><span style=" font-size:small;"> sender, System.ComponentModel.ProgressChangedEventArgs e)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      txtProgress.Content = (e.ProgressPercentage.ToString() + </span><span style=" font-size:small; color:#a31515;">&quot;%&quot;</span><span style=" font-size:small;">);</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      progressBar.Value = e.ProgressPercentage;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">void</span><span style=" font-size:small;"> BackgroundWorker_DoWork(</span><span style=" font-size:small; color:#0000ff;">object</span><span style=" font-size:small;"> sender, System.ComponentModel.DoWorkEventArgs e)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      BackgroundWorker worker = sender </span><span style=" font-size:small; color:#0000ff;">as</span><span style=" font-size:small;"> BackgroundWorker;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">for</span><span style=" font-size:small;"> (</span><span style=" font-size:small; color:#0000ff;">int</span><span style=" font-size:small;"> i = 1; (i &lt;= 10); i++)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">if</span><span style=" font-size:small;"> ((worker.CancellationPending == </span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">))</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">          e.Cancel = </span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">          </span><span style=" font-size:small; color:#0000ff;">break</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">else</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">          System.Threading.Thread.Sleep(500);</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">          worker.ReportProgress((i * 10));</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">void</span><span style=" font-size:small;"> BackgroundWorker_RunWorkerCompleted(</span><span style=" font-size:small; color:#0000ff;">object</span><span style=" font-size:small;"> sender, System.ComponentModel.RunWorkerCompletedEventArgs e)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">if</span><span style=" font-size:small;"> ((e.Cancelled == </span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">))</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.progressBar.Visibility = Visibility.Hidden;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.txtProgress.Content = </span><span style=" font-size:small; color:#a31515;">&quot;Отмена!&quot;</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">else</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">if</span><span style=" font-size:small;"> (!(e.Error == </span><span style=" font-size:small; color:#0000ff;">null</span><span style=" font-size:small;">))</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.progressBar.Visibility = Visibility.Hidden;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.txtProgress.Content = (</span><span style=" font-size:small; color:#a31515;">&quot;Ошибка: &quot;</span><span style=" font-size:small;"> + e.Error.Message);</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">else</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.txtProgress.Content = </span><span style=" font-size:small; color:#a31515;">&quot;Готово!&quot;</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        </span><span style=" font-size:small; color:#0000ff;">this</span><span style=" font-size:small;">.progressBar.Visibility = Visibility.Hidden;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        btnCancel.IsEnabled = </span><span style=" font-size:small; color:#0000ff;">false</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        btnStart.IsEnabled =</span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">void</span><span style=" font-size:small;"> btnStart_Click(</span><span style=" font-size:small; color:#0000ff;">object</span><span style=" font-size:small;"> sender, RoutedEventArgs e)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      btnStart.IsEnabled = </span><span style=" font-size:small; color:#0000ff;">false</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      btnCancel.IsEnabled = </span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      progressBar.Value = 0;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      progressBar.Visibility = Visibility.Visible;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      backgroundWorker.RunWorkerAsync();</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;"> </span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    </span><span style=" font-size:small; color:#0000ff;">private</span><span style=" font-size:small;"> </span><span style=" font-size:small; color:#0000ff;">void</span><span style=" font-size:small;"> btnCancel_Click(</span><span style=" font-size:small; color:#0000ff;">object</span><span style=" font-size:small;"> sender, RoutedEventArgs e)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      </span><span style=" font-size:small; color:#0000ff;">if</span><span style=" font-size:small;"> (backgroundWorker.WorkerSupportsCancellation == </span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">)</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      {</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        btnStart.IsEnabled = </span><span style=" font-size:small; color:#0000ff;">true</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        backgroundWorker.CancelAsync();</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">        btnCancel.IsEnabled = </span><span style=" font-size:small; color:#0000ff;">false</span><span style=" font-size:small;">;</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">      }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">    }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">  }</span></li>
<li style=" font-family:'Courier New'; font-size:8.25pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">}</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">* This source code was highlighted with </span><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><span style=" font-family:'Comic Sans MS,Tahoma,Arial'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#808080;">Source Code Highlighter</span></a><span style=" font-family:'Courier New,Courier,monospace'; font-size:8.25pt; color:#808080;">.</span></p></body></html>