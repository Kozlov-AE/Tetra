<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:9px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'sans-serif'; font-size:14px; color:#222222; background-color:#ffffff;">Следующий пример показывает метод расширения, определённый для класса System.String (в языке C# имеет псевдоним string). Заметим, что он определён внутри невложенного и ненастраиваемого статичного класса</span><a name="cite_ref-2"></a><a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D1%8F#cite_note-2"><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">[</span></a><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">2]</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">namespace</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#0000ff;">ExtensionMethods</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">    </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">public</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">static</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">class</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#0000ff;">MyExtensions</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">        </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-style:italic; color:#408080;">// метод WordCount принимает на вход строку, возвращает число слов, т.е. число подстрок, разделённых пробелом, точкой или вопросительным знаком.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">        </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">public</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">static</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#b00040;">int</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#0000ff;">WordCount</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">(</span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">this</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#b00040;">string</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> str)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">            </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">return</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> str.Split(</span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">new</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#b00040;">char</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">[] { </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#ba2121;">' '</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">, </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#ba2121;">'.'</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">, </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#ba2121;">'?'</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">, </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#ba2121;">'!'</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> }, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">                             StringSplitOptions.RemoveEmptyEntries).Length;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">    }   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:14px; color:#000000; background-color:#f8f9fa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; font-style:italic; color:#408080;">/* Метод-расширение WordCount появится в области видимости, если подключить соответствующее пространство имён: */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#008000;">using</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-weight:600; color:#0000ff;">ExtensionMethods</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:14px; color:#000000; background-color:#f8f9fa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; font-style:italic; color:#408080;">/* Теперь его можно вызвать: */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#b00040;">string</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> s = </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#ba2121;">&quot;Hello Extension Methods&quot;</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#b00040;">int</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> i = s.WordCount(); </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-style:italic; color:#408080;">// i получит значение 3</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f9fa;"><span style=" font-family:'monospace,monospace'; font-size:14px; color:#b00040;">int</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;"> j = </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#ba2121;">&quot;Съешь же ещё этих мягких французских булок, да выпей чаю.&quot;</span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000;">.WordCount(); </span><span style=" font-family:'monospace,monospace'; font-size:14px; font-style:italic; color:#408080;">// j получит значение 10</span></p>
<p style=" margin-top:9px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'sans-serif'; font-size:14px; color:#222222; background-color:#ffffff;">В сравнении с обычным методом, метод расширения статичен, а первый параметр содержит после</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;"> </span><span style=" font-family:'monospace,monospace'; font-size:14px; color:#000000; background-color:#f8f9fa;">this</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;"> целевой класс и переменную целевого класса, после чего могут следовать параметры метода</span><a name="cite_ref-_1af71c1b9005dd4b_3-0"></a><a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D1%8F#cite_note-_1af71c1b9005dd4b-3"><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">[</span></a><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">3]</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;">.</span></p>
<p style=" margin-top:9px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'sans-serif'; font-size:14px; color:#222222; background-color:#ffffff;">В C# метод расширения имеет доступ только к публичным членам класса. Другим ограничением является то, что если есть и встроенный метод, и расширение, приоритет даётся встроенному методу</span><a name="cite_ref-_1af71c1b9005dd4b_3-1"></a><a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D1%8F#cite_note-_1af71c1b9005dd4b-3"><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">[</span></a><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">3]</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;">.</span></p>
<p style=" margin-top:9px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'sans-serif'; font-size:14px; color:#222222; background-color:#ffffff;">Методы расширения широко используются в</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;"> </span><a href="https://ru.wikipedia.org/wiki/LINQ"><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080;">LINQ</span></a><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;">. Например, оператор Select является методом расширения интерфейса IEnumerable</span><a name="cite_ref-c-extension-methods_4-0"></a><a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D1%8F#cite_note-c-extension-methods-4"><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">[</span></a><span style=" font-family:'sans-serif'; font-size:14px; color:#0b0080; vertical-align:super;">4]</span><span style=" font-family:'sans-serif'; font-size:14px; color:#222222;">.</span></p></body></html>