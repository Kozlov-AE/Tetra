<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#343434;">DynamicData: Изменяющиеся коллекции, шаблон проектирования MVVM и реактивные расширения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:1.56%; background-color:#ffffff;"><a name="post-content-body"></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">В</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> феврале 2019 </span><span style=" color:#000000;">года состоялся релиз ReactiveUI 9 — кроссплатформенного фреймворка для построения приложений с GUI на платформе Microsoft .NET. ReactiveUI — это инструмент для тесной интеграции реактивных расширений с шаблоном проектирования MVVM. Знакомство с фреймворком можно начать с серии статей на Хабре или со вступительной страницы документации. Обновление ReactiveUI 9 включает в себя множество исправлений и улучшений, но, пожалуй, самое интересное и значимое изменение — тесная интеграция с фреймворком DynamicData, позволяющим работать с изменяющимися коллекциями в реактивном стиле. Попробуем разобраться, в каких случаях нам может пригодиться DynamicData и как устроен внутри этот мощный реактивный фреймворк!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:1.56%; background-color:#ffffff;"><span style=" color:#000000;">Предпосылки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />Для начала определим круг задач, решаемых </span><a href="https://github.com/RolandPheasant/DynamicData"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, и выясним, чем нас не устраивают стандартные инструменты для работы с изменяющимися наборами данных из пространства имён </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">System.Collections.ObjectModel</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">.<br /><br />Шаблон MVVM, как известно, предполагает разделение ответственности между слоями модели, представления и модели представления приложения. Слой модели представлен доменными сущностями и сервисами, и ничего не знает про модель представления. Слой модели инкапсулирует в себе всю сложную логику приложения, а модель представления делегирует операции модели, предоставляя представлению доступ к информации о текущем состоянии приложения через наблюдаемые свойства, команды и коллекции. Стандартный инструмент для работы с изменяющимися свойствами — это интерфейс </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">INotifyPropertyChanged</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, для работы с действиями пользователя — </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ICommand</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, а для работы с коллекциями — </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">INotifyCollectionChanged</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и реализации </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ReadOnlyObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">.<br /><br /></span><img src="image1581448245xu8ro5a9dd.png" /><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /><br />Реализация </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">INotifyPropertyChanged</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ICommand</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> обычно остаётся на совести разработчика и применяемого MVVM фреймворка, а вот использование </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> накладывает на нас ряд ограничений! Например, мы не можем изменить коллекцию из фонового потока без </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispatcher.Invoke</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> или схожего вызова, а это могло бы быть полезно в случае работы с массивами данных, которые синхронизирует с сервером некоторая фоновая операция. Необходимо заметить, что в идиоматичном MVVM слой модели не должен знать об используемой архитектуре GUI-приложения, и быть совместимым с моделью из MVC или MVP, и именно поэтому многочисленные </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispatcher.Invoke</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, позволяющие получить доступ к элементу управления пользовательского интерфейса из фонового потока, запущенного в доменном сервисе, нарушают принцип разделения ответственности между слоями приложения.<br /><br />Конечно, в доменном сервисе можно было бы объявить event, а в качестве аргументов события передавать чанк с изменившимися данными. Затем подписаться на событие, завернуть вызов </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispatcher.Invoke</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> в интерфейс, чтобы не зависеть от используемого GUI фреймворка, переместить </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispatcher.Invoke</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> в модель представления и изменить </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> нужным образом, однако существует намного более простой и элегантный способ решения обозначенного круга задач без необходимости написания велосипеда. Приступим к изучению!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#222222;">Реактивные расширения. Управляем потоками данных</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />Для полного понимания абстракций, вводимых </span><a href="https://github.com/RolandPheasant/DynamicData"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, и принципов работы с изменяющимися реактивными наборами данных, вспомним, </span><a href="https://habr.com/ru/post/418007/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">что такое реактивное программирование и как его применять в контексте платформы Microsoft .NET и шаблона проектирования MVVM</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Способ организации взаимодействия между компонентами программы может быть интерактивным и реактивным. При интерактивном взаимодействии функция-потребитель синхронно получает данные от функции-поставщика (pull-based подход, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">T</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IEnumerable</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">), а при реактивном взаимодействии функция-поставщик асинхронно поставляет данные функции-потребителю (push-based подход, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Task</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">).<br /><br /></span><img src="image15814482456tw5ktif1n.png" /><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /><br /></span><a href="http://reactivex.io/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">Реактивное программирование</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — это программирование с помощью асинхронных потоков данных, а реактивные расширения — частный случай его реализации, основанный на интерфейсах </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObserver</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> из пространства имён System, определяющий ряд LINQ-подобных операций над интерфейсом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, называемых LINQ over Observable. Реактивные расширения поддерживают .NET Standard и работают везде, где работает платформа Microsoft .NET.<br /><br /></span><img src="image1581448245jhw37wc0fv.png" /><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /><br />Фреймворк ReactiveUI предлагает разработчикам прикладных приложений воспользоваться реактивной реализацией интерфейсов </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ICommand</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">INotifyPropertyChanged</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, предоставляя такие мощные инструменты, как </span><a href="https://reactiveui.net/docs/handbook/commands/"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">ReactiveCommand&lt;TIn, TOut&gt;</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><a href="https://reactiveui.net/docs/handbook/when-any/"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">WhenAnyValue</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">WhenAnyValue</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> позволяет преобразовать свойство класса, реализующего INotifyPropertyChanged, в поток событий типа </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;T&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, что упрощает реализацию зависимых свойств.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">class</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">ExampleViewModel</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> : </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">ReactiveObject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  [</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">Reactive</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">] </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Атрибут ReactiveUI.Fody, занимается</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// аспектно-ориентированным внедрением</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// OnPropertyChanged в сеттер Name.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">string</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> Name { </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">get</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">; </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">set</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">ExampleViewModel</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Слушаем OnPropertyChanged(&quot;Name&quot;).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">this</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">.WhenAnyValue(x =&gt; x.Name)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">        </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Работаем с IObservable&lt;string&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">        .Subscribe(Console.WriteLine);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /></span><a href="https://reactiveui.net/docs/handbook/commands/"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">ReactiveCommand&lt;TIn, TOut&gt;</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> позволяет работать с командой, как с событием типа </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;TOut&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, которое публикуется всякий раз, когда команда завершает выполнение. Также у любой команды существует свойство </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ThrownExceptions</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> типа </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;Exception&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// ReactiveCommand&lt;Unit, int&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">var</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> command = ReactiveCommand.Create(() =&gt; </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#986801; background-color:#fbfdff;">42</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">command</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Работаем с IObservable&lt;int&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Subscribe(Console.WriteLine);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">command</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .ThrownExceptions</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Работаем с IObservable&lt;Exception&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Select(exception =&gt; exception.Message)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Работаем с IObservable&lt;string&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Subscribe(Console.WriteLine);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">command.Execute().Subscribe();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Вывод: 42</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />Всё это время мы работали с </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;T&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, как с событием, которое публикует новое значение типа </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">T</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> всякий раз, когда меняется состояние объекта, за которым ведётся наблюдение. Проще говоря, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;T&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — это поток событий, последовательность, растянутая во времени.<br /><br />Разумеется, мы могли бы точно так же легко и непринуждённо работать с коллекциями — всякий раз, когда коллекция меняется, публиковать новую коллекцию с изменившимися элементами. В таком случае, публикуемое значение имело бы тип </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IEnumerable&lt;T&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> или более специализированный, а само событие — тип </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IEnumerable&lt;T&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Но, как правильно подметит критически мыслящий читатель, это чревато серьёзными проблемами с производительностью приложения, особенно, если в нашей коллекции не десяток элементов, а сотня, а то и несколько тысяч!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#222222;">Введение в DynamicData</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /></span><a href="https://reactiveui.net/docs/handbook/collections"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — это библиотека, которая позволяет использовать всю мощь реактивных расширений при работе с коллекциями. Реактивные расширения из коробки не предоставляют оптимальных способов для работы с изменяющимися наборами данных, и задача </span><a href="https://reactiveui.net/docs/handbook/collections"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — исправить это. В большинстве прикладных приложений существует необходимость динамически обновлять коллекции — обычно, коллекция заполняется некоторыми элементами при запуске приложения, и далее асинхронно обновляется, синхронизируя информацию с сервером или базой данных. Современные приложения довольно сложны, и зачастую возникает необходимость создавать проекции коллекций — фильтровать, трансформировать или сортировать элементы. DynamicData была разработана как раз чтобы избавиться от того невероятно сложного кода, который потребовался бы нам для управления динамически меняющимися наборами данных. Инструмент активно развивается и дорабатывается, и уже сейчас поддерживается более 60 операторов для работы с коллекциями.<br /><br /></span><img src="image1581448245pc7p1l1noy.png" /><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /><br /></span><a href="https://reactiveui.net/docs/handbook/collections"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — это не альтернативная реализация </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollection&lt;T&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Архитектура </span><a href="https://reactiveui.net/docs/handbook/collections"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> основана прежде всего на концепциях предметно-ориентированного программирования. Идеология использования основана на том, что вы управляете некоторым источником данных, коллекцией, к которой имеет доступ код, ответственный за синхронизацию и изменение данных. Далее, вы применяете ряд операторов к источнику, с помощью которых можно декларативно трансформировать данные, без необходимости вручную создавать и изменять другие коллекции. Фактически, с </span><a href="https://reactiveui.net/docs/handbook/collections"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> вы разделяете операции чтения и записи, причём читать можете только реактивным способом — поэтому наследуемые коллекции всегда будут синхронизированы с источником.<br /><br />Вместо классического </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;T&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, DynamicData определяет операции над </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IChangeSet&lt;T&gt;&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IChangeSet&lt;TValue, TKey&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, где </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IChangeSet</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — чанк, содержащий информацию об изменении коллекции — тип изменения и элементы, которые были затронуты. Такой подход позволяет существенно улучшить производительность кода для работы с коллекциями, написанного в реактивном стиле. При этом, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IChangeSet&lt;T&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> всегда можно трансформировать в обычный </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IEnumerable&lt;T&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, если возникнет необходимость обработать все элементы коллекции сразу. Если звучит сложно — не пугайтесь, из примеров кода всё станет ясно и прозрачно!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#222222;">Пример использования DynamicData</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />Давайте рассмотрим ряд примеров, чтобы лучше понять, как работает DynamicData, чем отличается от </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">System.Reactive</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и какие задачи поможет решить рядовым разработчикам прикладного программного обеспечения с GUI. Начнём с комплексного примера, </span><a href="https://github.com/RolandPheasant/DynamicData"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">опубликованного автором DynamicData на GitHub</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. В примере источником данных является </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceCache&lt;Trade, long&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, содержащий коллекцию сделок. Задача — показать только активные сделки, трансформировать модели в proxy-объекты, отсортировать коллекцию.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Стандартная коллекция из System.Collections.ObjectModel,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// к которой будет привязан графический элемент управления.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">ReadOnlyObservableCollection&lt;TradeProxy&gt; list;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Изменяемый источник данных, содержащий модели сделок.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Можем использовать Add, Remove, Insert и подобные методы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">var</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> source = </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> SourceCache&lt;Trade, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">long</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">&gt;(trade =&gt; trade.Id);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">var</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> cancellation = source</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Трансформируем источник в наблюдаемый набор изменений.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Имеем тип IObservable&lt;IChangeSet&lt;Trade, long&gt;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Connect()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Дальше по цепочке пропустим только активные сделки.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Filter(trade =&gt; trade.Status == TradeStatus.Live) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Трансформируем модели в прокси-объекты.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Имеем тип IObservable&lt;IChangeSet&lt;TrandeProxy, long&gt;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Transform(trade =&gt; </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> TradeProxy(trade))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Отсортируем объекты по времени.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Sort(SortExpressionComparer&lt;TradeProxy&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    .Descending(trade =&gt; trade.Timestamp))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Обновляем GUI только из главного потока. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .ObserveOnDispatcher()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Привяжем список отсортированных прокси-объектов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// к коллекции из System.Collections.ObjectModel.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Bind(</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">out</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> list) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Убедимся, что по мере удаления элементов из</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// коллекции ресурсы будут освобождены.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .DisposeMany()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Subscribe();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />В примере выше, при изменении </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceCache</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, являющегося источником данных, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ReadOnlyObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> также соответствующим образом изменится. При этом, при удалении элементов из коллекции будет вызван метод </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispose</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, коллекция всегда будет обновляться только в GUI потоке и оставаться отсортированной и отфильтрованной. Круто, никаких </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispatcher.Invoke</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и сложного кода!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#222222;">Источники данных SourceList и SourceCache</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /></span><a href="https://github.com/RolandPheasant/DynamicData"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> предоставляет две специализированные коллекции, которые могут быть использованы в качестве изменяемого источника данных. Эти коллекции — типы </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceCache&lt;TObject, TKey&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Рекомендуется использовать </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceCache</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> всегда, когда </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">TObject</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> имеет уникальный ключ, в противном случае использовать </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Эти объекты предоставляют знакомый .NET разработчикам API для изменения данных — методы </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Add</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Remove</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Insert</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и подобные. Чтобы преобразовать источники данных в </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IChangeSet&lt;T&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> или </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IChangeSet&lt;T, TKey&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, используйте оператор </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">.Connect()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Например, если у вас есть сервис, обновляющий в фоне коллекцию элементов, вы с лёгкостью сможете синхронизировать список этих элементов с GUI, без </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Dispatcher.Invoke</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и архитектурных излишеств:<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">class</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">BackgroundService</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> : </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">IBackgroundService</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Объявляем изменяемый список сделок.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">private</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">readonly</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> SourceList&lt;Trade&gt; _trades;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Выставляем наружу поток изменений коллекции.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Если ожидается, что будет более одного подписчика,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// рекомендуется использовать оператор Publish() из Rx.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> IObservable&lt;IChangeSet&lt;Trade&gt;&gt; Connect() =&gt; _trades.Connect();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">BackgroundService</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    _trades = </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> SourceList&lt;Trade&gt;();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    _trades.Add(</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> Trade());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Изменяем список как хотим!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Даже из фонового потока.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /></span><a href="https://github.com/RolandPheasant/DynamicData"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> использует встроенные типы .NET для отображения данных во внешний мир. С помощью мощных операторов DynamicData мы можем преобразовать </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">IObservable&lt;IChangeSet&lt;Trade&gt;&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> в </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ReadOnlyObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> нашей модели представления.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">class</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">TradesViewModel</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> : </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">ReactiveObject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">{ </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">private</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">readonly</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> ReadOnlyObservableCollection&lt;TradeVm&gt; _trades;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> ReadOnlyObservableCollection&lt;TradeVm&gt; Trades =&gt; _trades;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">public</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#4078f2; background-color:#fbfdff;">TradesViewModel</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">(IBackgroundService background)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Подключимся к источнику, трансформируем элементы, привяжем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// их к коллекции из System.Collections.ObjectModel.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">    background.Connect()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">      .Transform(x =&gt; </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> TradeVm(x))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">      .ObserveOn(RxApp.MainThreadScheduler)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">      .Bind(</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">out</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> _trades)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">      .DisposeMany()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">      .Subscribe();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />Кроме </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Transform</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Filter</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Sort</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, DynamicData включает в себя массу других операторов, поддерживает группировку, логические операции, разглаживание коллекции, применение аггрегирующих функций, исключение одинаковых элементов, подсчёт элементов и даже виртуализацию на уровне модели представления. Подробнее обо всех операторах можно почитать в </span><a href="https://github.com/RolandPheasant/DynamicData/blob/master/README.md"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">README проекта на GitHub</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">.<br /><br /></span><img src="image15814482450gylz50a0u.png" /><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#222222;">Однопоточные коллекции и отслеживание изменений</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />Помимо </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">SourceCache</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, библиотека DynamicData также включает в себя однопоточную реализацию изменяемой коллекции — </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollectionExtended</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Чтобы синхронизировать две коллекции в вашей модели представления, объявите одну из них как </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollectionExtended</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, а другую — как </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ReadOnlyObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и воспользуйтесь оператором </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ToObservableChangeSet</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, который ведёт себя так же, как и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">Connect</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, но предназначен для работы с </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">ObservableCollection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Объявим производную коллекцию.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">ReadOnlyObservableCollection&lt;TradeVm&gt; _derived;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Объявим и инициализиуем коллекцию-источник.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">var</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> source = </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> ObservableCollectionExtended&lt;Trade&gt;();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">source.ToObservableChangeSet(trade =&gt; trade.Key)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Transform(trade =&gt; </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">new</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> TradeProxy(trade))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Filter(proxy =&gt; proxy.IsChecked)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Bind(</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">out</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> _derived)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Subscribe();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /></span><a href="https://github.com/RolandPheasant/DynamicData"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> также поддерживает отслеживание изменений в классах, реализующих интерфейс </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">INotifyPropertyChanged</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Например, если вы хотите получать уведомления об изменении коллекции всякий раз, когда свойство какого-либо элемента изменяется, используйте оператор </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">AutoRefresh</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и передайте аргументом селектор нужного свойства. </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">AutoRefesh</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и другие операторы DynamicData позволят легко и непринуждённо валидировать огромное количество форм и вложенных форм, отображаемых на экране!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Тип IObservable&lt;bool&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">var</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;"> isValid = databases</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .ToObservableChangeSet()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Подписываемся только на изменения свойства IsValid.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .AutoRefresh(database =&gt; database.IsValid) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Получаем доступ ко всем элементам коллекции одновременно.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .ToCollection()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Проверяем, что все элементы валидны.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .Select(x =&gt; x.All(y =&gt; y.IsValid));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// Если используется ReactiveUI, IObservable&lt;bool&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; font-style:italic; color:#a0a1a7; background-color:#fbfdff;">// можно преобразовать в свойство ObservableAsProperty.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">_isValid = isValid</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .ObserveOn(RxApp.MainThreadScheduler)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">  .ToProperty(</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#a626a4; background-color:#fbfdff;">this</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42; background-color:#fbfdff;">, x =&gt; x.IsValid);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#383a42;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br />На основе функциональности DynamicData можно быстро создавать достаточно сложные интерфейсы — особенно это актуально для систем, отображающих большое количество данных в реальном времени, систем обмена мгновенными сообщениями, систем мониторинга.<br /><br /></span><img src="image158144824597kyvtv8sw.png" /><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:-5px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:8.25pt; font-weight:496; color:#222222;">Заключение</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"><br /></span><a href="https://github.com/dotnet/reactive"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">Реактивные расширения</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> — мощный инструмент, позволяющий декларативно работать с данными и пользовательским интерфейсом, писать переносимый и поддерживаемый код, решать сложные задачи простым и элегантным способом. </span><a href="https://reactiveui.net/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">ReactiveUI</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> позволяет разработчикам на платформе .NET тесно интегрировать реактивные расширения в свои проекты, использующие архитектуру MVVM, предоставляя реактивные реализации </span><a href="https://reactiveui.net/docs/handbook/collections/"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">INotifyPropertyChanged</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><a href="https://reactiveui.net/docs/handbook/commands/"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">ICommand</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, а </span><a href="https://reactiveui.net/docs/handbook/collections/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> заботится о синхронизации коллекций, реализуя </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,monospace'; font-size:8.25pt; color:#222222;">INotifyCollectionChanged</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, расширяя возможности реактивных расширений и заботясь о производительности.<br /><br />Библиотеки </span><a href="https://reactiveui.net/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">ReactiveUI</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> и </span><a href="https://reactiveui.net/docs/handbook/collections/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;"> совместимы с большинством популярных GUI фреймворков платформы .NET, включая Windows Presentation Foundation, Universal Windows Platform, </span><a href="https://github.com/AvaloniaUI/Avalonia"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">Avalonia</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, Xamarin.Android, Xamarin Forms, Xamarin.iOS. Начать изучение DynamicData можно с </span><a href="https://reactiveui.net/docs/handbook/collections/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">соответствующей страницы документации ReactiveUI</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">. Также обязательно ознакомьтесь с проектом </span><a href="https://github.com/RolandPheasant/DynamicData.Snippets"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#992298; background-color:transparent;">DynamicData Snippets</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:8.25pt; color:#222222;">, содержащим примеры использования DynamicData на все случаи жизни.</span></p></body></html>